<h2>{{ editing ? 'Editar Menu' : 'Criar Menu' }}</h2>
<form [formGroup]="menuForm" (ngSubmit)="onSubmit()">
  <mat-form-field appearance="outline" style="width: 100%;">
    <mat-label>Categoria</mat-label>
    <mat-select formControlName="category" required>
      <mat-option *ngFor="let cat of categories" [value]="cat.name">{{ cat.name }}</mat-option>
    </mat-select>
  </mat-form-field>
  <div formArrayName="items">
    <div *ngFor="let item of items.controls; let i = index" [formGroupName]="i" class="menu-item-card">
      <mat-form-field appearance="outline" style="width: 100%;">
        <mat-label>Nome</mat-label>
        <input matInput formControlName="name" required />
      </mat-form-field>
      <mat-form-field appearance="outline" style="width: 100%;">
        <mat-label>Descrição</mat-label>
        <textarea matInput formControlName="description"></textarea>
      </mat-form-field>
      <mat-form-field appearance="outline" style="width: 100%;">
        <mat-label>Preço</mat-label>
        <input matInput type="number" formControlName="price" required />
      </mat-form-field>
      <mat-form-field appearance="outline" style="width: 100%;">
        <mat-label>Imagem (URL)</mat-label>
        <input matInput formControlName="image" />
      </mat-form-field>
      <mat-form-field appearance="outline" style="width: 100%;">
        <mat-label>Dose</mat-label>
        <input matInput formControlName="doseType" />
      </mat-form-field>
      <fieldset formGroupName="nutritionalInfo" class="nutritional-fieldset">
        <legend>Informação Nutricional</legend>
        <div class="nutritional-fields">
          <mat-form-field appearance="outline">
            <mat-label>Calorias</mat-label>
            <input matInput type="number" formControlName="calories" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Proteína</mat-label>
            <input matInput type="number" formControlName="protein" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Gordura</mat-label>
            <input matInput type="number" formControlName="fat" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Hidratos</mat-label>
            <input matInput type="number" formControlName="carbs" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Sódio</mat-label>
            <input matInput type="number" formControlName="sodium" />
          </mat-form-field>
        </div>
      </fieldset>
      <button mat-stroked-button color="warn" type="button" (click)="removeMenuItem(i)" *ngIf="items.length > 1" style="margin-top: 10px;">
        Remover prato
      </button>
    </div>
    <button mat-raised-button color="accent" type="button" (click)="addMenuItem()" style="margin: 18px 0;">
      Adicionar prato
    </button>
  </div>
  <button mat-raised-button color="primary" type="submit" [disabled]="menuForm.invalid || loading" style="margin-top: 24px;">
    {{ editing ? 'Guardar alterações' : 'Criar menu' }}
  </button>
</form>